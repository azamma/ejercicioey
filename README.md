# API Ejercicio EY

API RESTful para crear usuarios utilizando Java 8+, Spring Framework, Hibernate y una base de datos en memoria como HSQLDB o H2

## Tecnologías utilizadas

- Spring Boot
- Hibernate
- HSQLDB

## Requisitos previos

- Java 8
- Gradle

## Configuración de proyecto

1. Clonar el repositorio: `git clone https://github.com/azamma/ejercicioey`
2. Configurar las credenciales de la base de datos en el archivo `application.properties`.
3. Compilar utilizando Gradle.

## Configuración de application.properties

Modificar el server port con el puerto que se quiere correr la aplicación.
Cambiar el puerto en el spring.datasource.url por el puerto donde corre la hsqldb.
Modificar el username y password por las credenciales de la base de datos local.
Mantener como update para que únicamente actualice las tablas.
```properties
server.port=8081
spring.datasource.url=jdbc:hsqldb:hsql://localhost:9001
spring.datasource.username=SA
spring.datasource.password=
spring.datasource.driver-class-name=org.hsqldb.jdbc.JDBCDriver
spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=update
```

## Scripts para creación de tablas para HyperSQL

```sql
CREATE TABLE users (
id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
name VARCHAR(255) NOT NULL,
email VARCHAR(255) NOT NULL UNIQUE,
password VARCHAR(255) NOT NULL,
created DATE NOT NULL,
modified DATE NOT NULL,
last_login DATE NOT NULL,
token VARCHAR(255) NOT NULL,
isactive BOOLEAN NOT NULL
);

CREATE TABLE phones (
id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
number VARCHAR(255),
citycode VARCHAR(255),
countrycode VARCHAR(255),
user_id BIGINT,
CONSTRAINT fk_user
FOREIGN KEY (user_id)
REFERENCES users(id)
);
```
## Request de ejemplo

Los campos no pueden estar vacíos y además:

1. El campo "email" debe ser un correo electrónico válido.
2. El campo "password" debe contener una Mayuscula, letras minúsculas, y dos números.

```
POST /api/users
Content-Type: application/json
```

```json
{
    "name": "Jhon",
    "email": "Jhon@gmail.com",
    "password": "Password2023",
    "phones": [
        {
            "number": "1234567",
            "cityCode": "1",
            "countryCode": "57"
        }
    ]
}


```

# Response de ejemplo esperado 

```json
{
  "id": 20,
  "created": "2023-03-13T06:04:51",
  "modified": "2023-03-13T06:04:51",
  "lastLogin": "2023-03-13T06:04:51",
  "token": "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJKaG9uIiwiaWF0IjoxNjc4Njg3NDkxLCJzdWIiOiJKaG9uQGdtYWlsLmNvbSIsImlzcyI6IlphbW1hIiwiZXhwIjoxNjc4NjkzNDkxfQ.NyZ6J1OaOKqaaQQZJRBMYaZ0qGWpU9Qp6TD8LUkR_bU",
  "isActive": true
}

```